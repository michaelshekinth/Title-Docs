{"root":{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Wallet Architecture","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"toc-heading","version":1,"tag":"h1","id":"wallet-architecture"},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Smart (Proxy) Wallet — What & How","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"toc-heading","version":1,"tag":"h1","id":"smart-(proxy)-wallet-what-and-how"},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"What is a “Proxy Wallet” here?","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"toc-heading","version":1,"tag":"h2","id":"what-is-a-\"proxy-wallet\"-here"},{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"A non‑custodial smart account (a contract wallet) that belongs to the user but lives on‑chain.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":1},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"It uses Account Abstraction (ERC‑4337) so the account can:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":2},{"children":[{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Bundle multiple actions into one transaction (approve + buy + stake, etc.).","type":"text","version":1}],"direction":"ltr","format":"","indent":1,"type":"listitem","version":1,"value":1},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Use sponsored gas via a Paymaster (or pay gas in USDC).","type":"text","version":1}],"direction":"ltr","format":"","indent":1,"type":"listitem","version":1,"value":2},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Use session keys, spending limits, and social recovery.","type":"text","version":1}],"direction":"ltr","format":"","indent":1,"type":"listitem","version":1,"value":3}],"direction":"ltr","format":"","indent":0,"type":"list","version":1,"listType":"bullet","start":1,"tag":"ul"}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":3},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"It’s called “proxy” because we deploy a lightweight proxy (minimal proxy / EIP‑1167 or upgradeable proxy) that delegates logic to a single implementation contract.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":3},{"children":[{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"This makes deployment cheap (clones) and allows upgrades (with timelock & owner approval)","type":"text","version":1}],"direction":"ltr","format":"","indent":1,"type":"listitem","version":1,"value":1}],"direction":"ltr","format":"","indent":0,"type":"list","version":1,"listType":"bullet","start":1,"tag":"ul"}],"direction":null,"format":"","indent":0,"type":"listitem","version":1,"value":4}],"direction":"ltr","format":"","indent":0,"type":"list","version":1,"listType":"bullet","start":1,"tag":"ul"},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Ownership model (non‑custodial)","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"toc-heading","version":1,"tag":"h2","id":"ownership-model-(noncustodial)"},{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"The smart account is owned by the user’s key:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":1},{"children":[{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Either EOA (MetaMask/Trust/WalletConnect)","type":"text","version":1}],"direction":"ltr","format":"","indent":1,"type":"listitem","version":1,"value":1},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Or Magic.link key (MPC, non‑custodial).","type":"text","version":1}],"direction":"ltr","format":"","indent":1,"type":"listitem","version":1,"value":2}],"direction":"ltr","format":"","indent":0,"type":"list","version":1,"listType":"bullet","start":1,"tag":"ul"}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":2},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"The platform never holds keys. Ownership & recovery modules are on‑chain.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":2}],"direction":"ltr","format":"","indent":0,"type":"list","version":1,"listType":"bullet","start":1,"tag":"ul"},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"When & how the wallet is created","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"toc-heading","version":1,"tag":"h2","id":"when-and-how-the-wallet-is-created"},{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"On signup, we derive a counterfactual address (via ","type":"text","version":1},{"detail":0,"format":16,"mode":"normal","style":"","text":"CREATE2","type":"text","version":1},{"detail":0,"format":0,"mode":"normal","style":"","text":") for the user’s smart account—no gas spent yet.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":1},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"On the first action (e.g., first trade/deposit), the AccountFactory deploys the proxy at that deterministic address and initializes:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":2},{"children":[{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Owner(s) (EOA or Magic.link)","type":"text","version":1}],"direction":"ltr","format":"","indent":1,"type":"listitem","version":1,"value":1},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Modules (session keys, recovery, spending limits)","type":"text","version":1}],"direction":"ltr","format":"","indent":1,"type":"listitem","version":1,"value":2},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"USDC as primary collateral and ERC‑1155 positions as holdings","type":"text","version":1}],"direction":"ltr","format":"","indent":1,"type":"listitem","version":1,"value":3}],"direction":"ltr","format":"","indent":0,"type":"list","version":1,"listType":"bullet","start":1,"tag":"ul"}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":3},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"We maintain a Registry mapping ","type":"text","version":1},{"detail":0,"format":16,"mode":"normal","style":"","text":"userId → smartAccountAddress","type":"text","version":1},{"detail":0,"format":0,"mode":"normal","style":"","text":" per chain.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":3}],"direction":"ltr","format":"","indent":0,"type":"list","version":1,"listType":"bullet","start":1,"tag":"ul"},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Where funds and positions live","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"toc-heading","version":1,"tag":"h2","id":"where-funds-and-positions-live"},{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"USDC collateral sits inside the user’s proxy wallet or inside the market contract/AMM while a trade is open.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":1},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Market positions are ERC‑1155 tokens minted to the user’s proxy wallet address.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":2},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Selling or winning credits USDC back to the proxy wallet.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":3}],"direction":"ltr","format":"","indent":0,"type":"list","version":1,"listType":"bullet","start":1,"tag":"ul"},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Multi‑chain deposits (“Deposities”)","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"toc-heading","version":1,"tag":"h2","id":"multichain-deposits-(\"deposities\")"},{"children":[{"detail":0,"format":1,"mode":"normal","style":"","text":"Goal:","type":"text","version":1},{"detail":0,"format":0,"mode":"normal","style":"","text":" Let users send supported tokens (e.g., ","type":"text","version":1},{"detail":0,"format":1,"mode":"normal","style":"","text":"USDC","type":"text","version":1},{"detail":0,"format":0,"mode":"normal","style":"","text":") from ","type":"text","version":1},{"detail":0,"format":1,"mode":"normal","style":"","text":"several chains","type":"text","version":1},{"detail":0,"format":0,"mode":"normal","style":"","text":" and have them available quickly for ","type":"text","version":1},{"detail":0,"format":1,"mode":"normal","style":"","text":"Polygon trading","type":"text","version":1},{"detail":0,"format":0,"mode":"normal","style":"","text":"—without losing control.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":1,"mode":"normal","style":"","text":"Design (hub & spokes):","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Polygon is the hub where markets run and the proxy wallet primarily operates.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":1},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Users may deposit on source chains they already hold assets on (e.g., Ethereum, Arbitrum, Base).","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":2},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"A DepositRouter (source) contract accepts deposits and uses a Bridge Adapter:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":3},{"children":[{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"USDC: prefer Circle CCTP (burn/mint) for native USDC with minimal liquidity risk.","type":"text","version":1}],"direction":"ltr","format":"","indent":1,"type":"listitem","version":1,"value":1},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Other tokens: use CCIP / Axelar adapters (configurable).","type":"text","version":1}],"direction":"ltr","format":"","indent":1,"type":"listitem","version":1,"value":2}],"direction":"ltr","format":"","indent":0,"type":"list","version":1,"listType":"bullet","start":1,"tag":"ul"}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":4},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"On Polygon, a DepositRouter (hub) receives the bridged funds and credits the user’s proxy wallet.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":4}],"direction":"ltr","format":"","indent":0,"type":"list","version":1,"listType":"bullet","start":1,"tag":"ul"},{"children":[{"detail":0,"format":1,"mode":"normal","style":"","text":"Security & UX:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Each deposit mints a DepositReceipt (event + id) for traceability.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":1},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Replays are prevented by deposit nonce tracking.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":2},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Timeouts/fallbacks if a bridge is congested.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":3},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Notifications/Webhooks update UI when funds arrive.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":4}],"direction":"ltr","format":"","indent":0,"type":"list","version":1,"listType":"bullet","start":1,"tag":"ul"},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Why bundling + paymaster matter","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"toc-heading","version":1,"tag":"h2","id":"why-bundling-+-paymaster-matter"},{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"With ERC‑4337, the user signs a UserOperation that can:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":1},{"children":[{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Perform multi‑call: approve USDC → buy YES/NO → store receipt.","type":"text","version":1}],"direction":"ltr","format":"","indent":1,"type":"listitem","version":1,"value":1},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Be sponsored so no MATIC is needed in the user wallet.","type":"text","version":1}],"direction":"ltr","format":"","indent":1,"type":"listitem","version":1,"value":2},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Optionally pay gas in USDC via a paymaster policy.","type":"text","version":1}],"direction":"ltr","format":"","indent":1,"type":"listitem","version":1,"value":3}],"direction":"ltr","format":"","indent":0,"type":"list","version":1,"listType":"bullet","start":1,"tag":"ul"}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":2},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Result: Fast, single‑click trades, fewer signature popups, higher conversion.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"listitem","version":1,"value":2}],"direction":"ltr","format":"","indent":0,"type":"list","version":1,"listType":"bullet","start":1,"tag":"ul"},{"altText":"","caption":{"editorState":{"root":{"children":[],"direction":null,"format":"","indent":0,"type":"root","version":1}}},"showCaption":false,"showBorder":true,"src":"_images/Trade flow - Soundbet _ Mermaid Chart-2025-08-12-220907.png","type":"image","version":1,"width":"100%","align":"center"}],"direction":"ltr","format":"","indent":0,"type":"root","version":1}}